<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Octave package for Queueing Networks and Markov chains analysis: dtmcmtta</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" integrity="sha512-1ycn6IcaQQ40/MKBW2W4Rhis/DbILU74C1vSrLJxCq57o941Ym01SwNsOMqvEBFlcgUa6xLiPY/NS5R+E6ztJQ==" crossorigin="anonymous" referrerpolicy="no-referrer">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-U1DAWAznBHeqEIlVSCgzq+c9gqGAJn5c/t99JyeKa9xxaYpSvHU5awsuZVVFIhvj" crossorigin="anonymous"></script>
    <script type="text/javascript" async
      src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML">
    </script>
    <style>
    var {
      font-style: italics;
      font-weight: bold;
    }
    td {
      vertical-align: top;
    }
    </style>
  </head>
  <body>
    <div class="bg-dark">
      <div class="container-xl">
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
          <div class="container-fluid">
            <a class="navbar-brand" href=index.html>
              <img src="assets/queueing.png" alt="queueing" class="d-inline-block align-top" width="25" height="25">
              Octave package for Queueing Networks and Markov chains analysis
            </a>
            <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
              <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
              <ul class="navbar-nav">
                <li class="nav-item">
                  <a class="nav-link" href="index.html#Discrete-time Markov chains">
                    <i class="fas fa-list-alt"></i>
                    Discrete-time Markov chains
                  </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="https://gnu-octave.github.io/packages/">
                  <img src="assets/octave-logo.svg" alt="GNU Octave logo" class="d-inline-block align-top" width="25" height="25">
                    Octave Packages
                  </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="https://www.octave.org">
                    <i class="fas fa-home"></i>
                    GNU Octave website
                  </a>
                </li>
              </ul>
            </div>
          </div>
        </nav>
      </div>
    </div>
    <div class="container-xl my-4">
      <div class="card rounded">
        <div class="card-header card-header-mod">
          <div class="row d-flex flex-wrap align-items-center">
            <div class="col-sm-3 col-md-5 mb-2 mb-sm-0">
              <h3 class="d-inline-block mr-2">
              Function&nbsp;Reference: <b><code>dtmcmtta</code></b>
              </h3>
            </div>
          </div>
        </div>
        <div class="card-body">
<dl>
<dt><u>Function File:</u> [<var>t</var> <var>N</var> <var>B</var>] = <b>dtmcmtta</b><i> (<var>P</var>)</i></dt>
<dt><u>Function File:</u> [<var>t</var> <var>N</var> <var>B</var>] = <b>dtmcmtta</b><i> (<var>P</var>, <var>p0</var>)</i></dt>
</dl>

 <a name="index-mean-time-to-absorption_002c-DTMC"></a>
 <a name="index-absorption-probabilities_002c-DTMC"></a>
 <a name="index-fundamental-matrix"></a>
 <a name="index-DTMC"></a>
 <a name="index-discrete-time-Markov-chain"></a>
 <a name="index-Markov-chain_002c-discrete-time"></a>

<p> Compute the expected number of steps before absorption for a
 DTMC with state space <math>1, &hellip;, N</math>
 and transition probability matrix <var>P</var>.
</p>
<div class="ms-5">
<p> <strong>INPUTS</strong>
</p>
 <dl compact="compact">
<dt> <code><var>P</var>(i,j)</code></dt>
</dl>
<p> <math>N \times N</math> transition probability matrix.
 <code><var>P</var>(i,j)</code> is the transition probability from state
 <math>i</math> to state <math>j</math>.
</p>
 </dd>
<dt> <code><var>p0</var>(i)</code></dt>
</dl>
<p> Initial state occupancy probabilities (vector of length <math>N</math>).
</p>
</dd>
</dl>

<p> <strong>OUTPUTS</strong>
</p>
 <dl compact="compact">
<dt> <code><var>t</var></code></dt>
<dt> <code><var>t</var>(i)</code></dt>
</dl>
<p> When called with a single argument, <var>t</var> is a vector of length
 <math>N</math> such that <code><var>t</var>(i)</code> is the expected number of steps
 before being absorbed in any absorbing state, starting from state
 <math>i</math>; if <math>i</math> is absorbing, <code><var>t</var>(i) = 0</code>. When
 called with two arguments, <var>t</var> is a scalar, and represents the
 expected number of steps before absorption, starting from the initial
 state occupancy probability <var>p0</var>.
</p>
 </dd>
<dt> <code><var>N</var>(i)</code></dt>
<dt> <code><var>N</var>(i,j)</code></dt>
</dl>
<p> When called with a single argument, <var>N</var> is the <math>N \times N</math>
 fundamental matrix for <var>P</var>. <code><var>N</var>(i,j)</code> is the expected
 number of visits to transient state <var>j</var> before absorption, if the
 system started in transient state <var>i</var>. The initial state is counted
 if <math>i = j</math>. When called with two arguments, <var>N</var> is a vector
 of length <math>N</math> such that <code><var>N</var>(j)</code> is the expected number
 of visits to transient state <var>j</var> before absorption, given initial
 state occupancy probability <var>P0</var>.
</p>
 </dd>
<dt> <code><var>B</var>(i)</code></dt>
<dt> <code><var>B</var>(i,j)</code></dt>
</dl>
<p> When called with a single argument, <var>B</var> is a <math>N \times N</math>
 matrix where <code><var>B</var>(i,j)</code> is the probability of being
 absorbed in state <math>j</math>, starting from transient state <math>i</math>;
 if <math>j</math> is not absorbing, <code><var>B</var>(i,j) = 0</code>; if <math>i</math>
 is absorbing, <code><var>B</var>(i,i) = 1</code> and <code><var>B</var>(i,j) = 0</code>
 for all <math>i \neq j</math>. When called with two arguments, <var>B</var> is
 a vector of length <math>N</math> where <code><var>B</var>(j)</code> is the
 probability of being absorbed in state <var>j</var>, given initial state
 occupancy probabilities <var>p0</var>.
</p>
</dd>
</dl>

<p> <strong>REFERENCES</strong>
</p>
 <ul>
<li> Grinstead, Charles M.; Snell, J. Laurie (July
 1997). <cite>Introduction to Probability</cite>, Ch. 11: Markov
 Chains. American Mathematical Society. ISBN 978-0821807491.
 </li></ul>

<p> <strong>See also: </strong>
  <a href="ctmcmtta.html">ctmcmtta</a>
</p>
</div>
        <div class="container-xl my-4">
          <div class="card rounded">
            <div class="card-header card-header-mod">
              <div class="row d-flex flex-wrap align-items-center">
                <div class="col-sm-3 col-md-5 mb-2 mb-sm-0">
                  <h3 class="d-inline-block mr-2">
                  Example: 1
                  </h3>
                </div>
              </div>
            </div>
            <div class="card-body">
              <div class="container bg-light">
                <div class="row">
                  <table><tbody><tr>
                    <td>&nbsp;</td>
                    <td><pre class="example">

 n = 6;
 P = zeros(101,101);
 for j=0:(100-n)
   i=1:n;
   P(1+j,1+j+i) = 1/n;
 endfor
 for j=(101-n):100
   P(1+j,1+j) = (n-100+j)/n;
 endfor
 for j=(101-n):100
   i=1:(100-j);
   P(1+j,1+j+i) = 1/n;
 endfor
 Pstar = P;
 ## setup snakes and ladders
 SL = [1 38; ...
       4 14; ...
       9 31; ...
       16 6; ...
       21 42; ...
       28 84; ...
       36 44; ...
       47 26; ...
       49 11; ...
       51 67; ...
       56 53; ...
       62 19; ...
       64 60; ...
       71 91; ...
       80 100; ...
       87 24; ...
       93 73; ...
       95 75; ...
       98 78 ];
 for ii=1:rows(SL);
   i = SL(ii,1);
   j = SL(ii,2);
   Pstar(1+i,:) = 0;
   for k=0:100
     if ( k != i )
       Pstar(1+k,1+j) = P(1+k,1+j) + P(1+k,1+i);
     endif
   endfor
   Pstar(:,1+i) = 0;
 endfor
 Pstar += diag( 1-sum(Pstar,2) );
 # spy(Pstar); pause
 nsteps = 250; # number of steps
 Pfinish = zeros(1,nsteps); # Pfinish(i) = probability of finishing after step i
 pstart = zeros(1,101); pstart(1) = 1; pn = pstart;
 for i=1:nsteps
   pn = pn*Pstar;
   Pfinish(i) = pn(101); # state 101 is the ending (absorbing) state
 endfor
 f = dtmcmtta(Pstar,pstart);
 printf("Average number of steps to complete 'snakes and ladders': %f\n", f );
 plot(Pfinish,"linewidth",2);
 line([f,f],[0,1]);
 text(f*1.1,0.2,["Mean Time to Absorption (" num2str(f) ")"]);
 xlabel("Step number (n)");
 title("Probability of finishing 'snakes and ladders' before step n");

Average number of steps to complete 'snakes and ladders': 39.225122
                    </pre></td></tr></tbody>
                  </table>
                  <div class="text-center">
                    <img src="assets/dtmcmtta_101.png" class="rounded img-thumbnail" alt="plotted figure">
                  </div><p></p>

                </div>
              </div>
            </div>
          </div>
        </div>


        </div>
      </div>
    </div>

  </body>
</html>
